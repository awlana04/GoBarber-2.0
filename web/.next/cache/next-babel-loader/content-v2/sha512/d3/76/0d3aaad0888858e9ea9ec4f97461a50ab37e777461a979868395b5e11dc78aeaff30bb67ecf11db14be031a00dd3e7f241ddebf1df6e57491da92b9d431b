{"ast":null,"code":"import { verify } from 'jsonwebtoken';\nexport function getUserId(context) {\n  const authHeader = context.request.get('Authorization');\n\n  if (authHeader) {\n    const token = authHeader.replace('Bearer', '');\n    const verifiedToken = verify(token, process.env.APP_SECRET);\n    return verifiedToken && String(verifiedToken.userId);\n  }\n}","map":{"version":3,"sources":["/home/lon1/Documents/scripts/www/GoBarber-2.0/web/src/pages/api/utils/getUserId.ts"],"names":["verify","getUserId","context","authHeader","request","get","token","replace","verifiedToken","process","env","APP_SECRET","String","userId"],"mappings":"AAAA,SAASA,MAAT,QAAuB,cAAvB;AAQA,OAAO,SAASC,SAAT,CAAmBC,OAAnB,EAAqC;AAC1C,QAAMC,UAAU,GAAGD,OAAO,CAACE,OAAR,CAAgBC,GAAhB,CAAoB,eAApB,CAAnB;;AAEA,MAAIF,UAAJ,EAAgB;AACd,UAAMG,KAAK,GAAGH,UAAU,CAACI,OAAX,CAAmB,QAAnB,EAA6B,EAA7B,CAAd;AAEA,UAAMC,aAAa,GAAGR,MAAM,CAACM,KAAD,EAAQG,OAAO,CAACC,GAAR,CAAYC,UAApB,CAA5B;AAEA,WAAOH,aAAa,IAAII,MAAM,CAACJ,aAAa,CAACK,MAAf,CAA9B;AACD;AACF","sourcesContent":["import { verify } from 'jsonwebtoken';\n\nimport { Context } from '../nexus/context';\n\ninterface Token {\n  userId: string;\n}\n\nexport function getUserId(context: Context) {\n  const authHeader = context.request.get('Authorization');\n\n  if (authHeader) {\n    const token = authHeader.replace('Bearer', '');\n\n    const verifiedToken = verify(token, process.env.APP_SECRET) as Token;\n\n    return verifiedToken && String(verifiedToken.userId);\n  }\n}\n"]},"metadata":{},"sourceType":"module"}