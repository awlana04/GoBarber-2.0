{"ast":null,"code":"import { objectType, nonNull, stringArg } from 'nexus';\nimport { hash } from 'bcryptjs';\nimport { sign } from 'jsonwebtoken';\nexport const Mutation = objectType({\n  name: 'Mutation',\n\n  definition(t) {\n    t.field('signup', {\n      type: 'AuthPayload',\n      args: {\n        email: nonNull(stringArg()),\n        password: nonNull(stringArg())\n      },\n      resolve: async (_parent, args, context) => {\n        const hashedPassword = await hash(args.password, 10);\n        const user = await context.prisma.user.create({\n          data: {\n            email: args.email,\n            password: hashedPassword\n          }\n        });\n        return {\n          token: sign({\n            userId: user.id\n          }, process.env.APP_SECRET),\n          user\n        };\n      }\n    });\n  }\n\n});","map":{"version":3,"sources":["/home/lon1/Documents/scripts/www/GoBarber-2.0/web/src/pages/api/graphql/resolvers/Mutation.ts"],"names":["objectType","nonNull","stringArg","hash","sign","Mutation","name","definition","t","field","type","args","email","password","resolve","_parent","context","hashedPassword","user","prisma","create","data","token","userId","id","process","env","APP_SECRET"],"mappings":"AAAA,SAASA,UAAT,EAAqBC,OAArB,EAA8BC,SAA9B,QAA+C,OAA/C;AACA,SAAkBC,IAAlB,QAA8B,UAA9B;AACA,SAASC,IAAT,QAAqB,cAArB;AAKA,OAAO,MAAMC,QAAQ,GAAGL,UAAU,CAAC;AACjCM,EAAAA,IAAI,EAAE,UAD2B;;AAEjCC,EAAAA,UAAU,CAACC,CAAD,EAAI;AACZA,IAAAA,CAAC,CAACC,KAAF,CAAQ,QAAR,EAAkB;AAChBC,MAAAA,IAAI,EAAE,aADU;AAEhBC,MAAAA,IAAI,EAAE;AACJC,QAAAA,KAAK,EAAEX,OAAO,CAACC,SAAS,EAAV,CADV;AAEJW,QAAAA,QAAQ,EAAEZ,OAAO,CAACC,SAAS,EAAV;AAFb,OAFU;AAMhBY,MAAAA,OAAO,EAAE,OAAOC,OAAP,EAAgBJ,IAAhB,EAAsBK,OAAtB,KAA2C;AAClD,cAAMC,cAAc,GAAG,MAAMd,IAAI,CAACQ,IAAI,CAACE,QAAN,EAAgB,EAAhB,CAAjC;AAEA,cAAMK,IAAI,GAAG,MAAMF,OAAO,CAACG,MAAR,CAAeD,IAAf,CAAoBE,MAApB,CAA2B;AAC5CC,UAAAA,IAAI,EAAE;AACJT,YAAAA,KAAK,EAAED,IAAI,CAACC,KADR;AAEJC,YAAAA,QAAQ,EAAEI;AAFN;AADsC,SAA3B,CAAnB;AAOA,eAAO;AACLK,UAAAA,KAAK,EAAElB,IAAI,CAAC;AAAEmB,YAAAA,MAAM,EAAEL,IAAI,CAACM;AAAf,WAAD,EAAsBC,OAAO,CAACC,GAAR,CAAYC,UAAlC,CADN;AAELT,UAAAA;AAFK,SAAP;AAID;AApBe,KAAlB;AAsBD;;AAzBgC,CAAD,CAA3B","sourcesContent":["import { objectType, nonNull, stringArg } from 'nexus';\nimport { compare, hash } from 'bcryptjs';\nimport { sign } from 'jsonwebtoken';\n\nimport { Context } from '../../context';\nimport { getUserId } from '../../utils/getUserId';\n\nexport const Mutation = objectType({\n  name: 'Mutation',\n  definition(t) {\n    t.field('signup', {\n      type: 'AuthPayload',\n      args: {\n        email: nonNull(stringArg()),\n        password: nonNull(stringArg()),\n      },\n      resolve: async (_parent, args, context: Context) => {\n        const hashedPassword = await hash(args.password, 10);\n\n        const user = await context.prisma.user.create({\n          data: {\n            email: args.email,\n            password: hashedPassword,\n          },\n        })\n\n        return {\n          token: sign({ userId: user.id }, process.env.APP_SECRET as string),\n          user,\n        }\n      },\n    })\n  }\n})\n"]},"metadata":{},"sourceType":"module"}